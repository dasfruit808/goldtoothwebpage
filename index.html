<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gold Tooth - Upcoming Shows (GB Style)</title>
    <link rel="stylesheet" href="styles.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body class="site-wrapper">

    <div id="loadingScreen" class="loading-screen">
        <div class="loading-frame">
            <div class="loading-display">
                <div class="loading-logo">Gold Tooth</div>
                <div class="loading-progress">
                    <div class="loading-bar"></div>
                </div>
                <p class="loading-text">LOADING</p>
            </div>
        </div>
    </div>

    <div class="gameboy-shell">
        <div class="screen-bezel">
            <div class="screen-label">
                <span class="status-led" aria-hidden="true"></span>
            </div>
            <div class="screen-inner">
                <div class="screen-frame">
                    <nav class="top-toolbar" aria-label="Primary navigation">
                        <a class="toolbar-link is-active" href="#" data-destination="shows">Shows</a>
                        <a class="toolbar-link" href="#" data-destination="spotify">Spotify</a>
                        <a class="toolbar-link" href="#" data-destination="shop">Shop</a>
                        <a class="toolbar-link" href="#" data-destination="instagram">Instagram</a>
                    </nav>

                    <div class="panel-window">
                        <div class="panel-stack">
                            <main class="content-section screen-panel" data-panel="shows">
                                <h2>Upcoming Shows</h2>

                                <ul class="show-list">
                            <li>
                                <span class="date">Oct 24</span>:
                                <a href="https://tickets.wethebeat.com/e/thebuttertones-swan-dive/tickets?utm_source=affiliate&utm_name=Artist&utm_campaign=Artist&utm_id=686d8435c93c46d29fb73d7b0a1e63a2" target="_blank" rel="noopener noreferrer">Las Vegas, NV - Swan Dive</a>
                            </li>
                            <li>
                                <span class="date">Oct 26</span>:
                                <a href="https://bandsintown.com/t/1035894547?affil_code=js_thebuttertones.com&app_id=js_thebuttertones.com&came_from=700&ticket_id=1681128626&utm_campaign=ticket_tktpp&utm_medium=web&utm_source=widget" target="_blank" rel="noopener noreferrer">Sacramento, CA - Ace of Spades</a>
                            </li>
                            <li>
                                <span class="date">Oct 27</span>:
                                <a href="https://www.tixr.com/groups/cornerstoneberkeley/events/the-buttertones-150298" target="_blank" rel="noopener noreferrer">Berkley, CA - Cornerstone</a>
                            </li>
                            <li>
                                <span class="date">Nov 15</span>:
                                <a href="https://www.bandsintown.com/t/1035863823?affil_code=js_thebuttertones.com&app_id=js_thebuttertones.com&came_from=700&ticket_id=1682081070&utm_campaign=ticket_tktpp&utm_medium=web&utm_source=widget" target="_blank" rel="noopener noreferrer">Santa Ana, CA - The Observatory</a>
                            </li>
                        </ul>

                        <p class="cta-message">Get your tickets before they sell out!</p>
                    </main>

                    <section class="content-section screen-panel" data-panel="shop" hidden>
                        <h2>Shop</h2>
                        <ul class="shop-list">
                            <li>
                                <span class="item-title">Limited Run Cassette</span>
                                <span class="item-tag">Only 150 copies</span>
                            </li>
                            <li>
                                <span class="item-title">Tour Tee</span>
                                <span class="item-tag">XS&ndash;XXL</span>
                            </li>
                            <li>
                                <span class="item-title">Glow-in-the-dark Sticker Set</span>
                                <span class="item-tag">3-pack</span>
                            </li>
                        </ul>
                        <p class="shop-copy">Merch is fulfilled by our partners and ships worldwide.</p>
                        <a class="button-link" href="https://goldtooth.bigcartel.com" target="_blank" rel="noopener noreferrer">
                            Visit the Online Store
                        </a>
                    </section>

                    <section id="spotifyPanel" class="content-section screen-panel" data-panel="spotify" hidden>
                        <h2 class="visually-hidden">Spotify Player</h2>
                        <iframe
                            title="Gold Tooth on Spotify"
                            src="https://open.spotify.com/embed/artist/2NCtq9PgO9tZNslClm0ibY"
                            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                            loading="lazy"
                        ></iframe>
                        <div class="sequencer" aria-labelledby="sequencerTitle">
                            <div class="sequencer-header">
                                <h3 id="sequencerTitle">Pocket Sequencer</h3>
                                <div class="transport-controls" role="group" aria-label="Transport controls">
                                    <button type="button" class="pixel-button" data-action="start">Start</button>
                                    <button type="button" class="pixel-button is-secondary" data-action="stop">Stop</button>
                                </div>
                            </div>
                            <p class="sequencer-instructions">Tap the pads to arm steps for each track, then press Start to loop a lo-fi groove.</p>
                            <div class="tempo-control">
                                <label for="tempoInput">Tempo</label>
                                <input id="tempoInput" type="range" min="60" max="180" value="110" step="5">
                                <output id="tempoDisplay" for="tempoInput">110&nbsp;BPM</output>
                            </div>
                            <div class="step-grid" role="grid" aria-label="Four-track step sequencer">
                                <div class="step-row" role="row">
                                    <span class="track-label" role="rowheader">Kick</span>
                                    <button type="button" class="pad-button" role="gridcell" data-track="kick" data-step="0" aria-pressed="false" aria-label="Kick step 1"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="kick" data-step="1" aria-pressed="false" aria-label="Kick step 2"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="kick" data-step="2" aria-pressed="false" aria-label="Kick step 3"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="kick" data-step="3" aria-pressed="false" aria-label="Kick step 4"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="kick" data-step="4" aria-pressed="false" aria-label="Kick step 5"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="kick" data-step="5" aria-pressed="false" aria-label="Kick step 6"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="kick" data-step="6" aria-pressed="false" aria-label="Kick step 7"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="kick" data-step="7" aria-pressed="false" aria-label="Kick step 8"></button>
                                </div>
                                <div class="step-row" role="row">
                                    <span class="track-label" role="rowheader">Snare</span>
                                    <button type="button" class="pad-button" role="gridcell" data-track="snare" data-step="0" aria-pressed="false" aria-label="Snare step 1"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="snare" data-step="1" aria-pressed="false" aria-label="Snare step 2"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="snare" data-step="2" aria-pressed="false" aria-label="Snare step 3"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="snare" data-step="3" aria-pressed="false" aria-label="Snare step 4"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="snare" data-step="4" aria-pressed="false" aria-label="Snare step 5"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="snare" data-step="5" aria-pressed="false" aria-label="Snare step 6"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="snare" data-step="6" aria-pressed="false" aria-label="Snare step 7"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="snare" data-step="7" aria-pressed="false" aria-label="Snare step 8"></button>
                                </div>
                                <div class="step-row" role="row">
                                    <span class="track-label" role="rowheader">Hat</span>
                                    <button type="button" class="pad-button" role="gridcell" data-track="hat" data-step="0" aria-pressed="false" aria-label="Hat step 1"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="hat" data-step="1" aria-pressed="false" aria-label="Hat step 2"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="hat" data-step="2" aria-pressed="false" aria-label="Hat step 3"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="hat" data-step="3" aria-pressed="false" aria-label="Hat step 4"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="hat" data-step="4" aria-pressed="false" aria-label="Hat step 5"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="hat" data-step="5" aria-pressed="false" aria-label="Hat step 6"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="hat" data-step="6" aria-pressed="false" aria-label="Hat step 7"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="hat" data-step="7" aria-pressed="false" aria-label="Hat step 8"></button>
                                </div>
                                <div class="step-row" role="row">
                                    <span class="track-label" role="rowheader">Lead</span>
                                    <button type="button" class="pad-button" role="gridcell" data-track="blip" data-step="0" aria-pressed="false" aria-label="Lead step 1"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="blip" data-step="1" aria-pressed="false" aria-label="Lead step 2"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="blip" data-step="2" aria-pressed="false" aria-label="Lead step 3"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="blip" data-step="3" aria-pressed="false" aria-label="Lead step 4"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="blip" data-step="4" aria-pressed="false" aria-label="Lead step 5"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="blip" data-step="5" aria-pressed="false" aria-label="Lead step 6"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="blip" data-step="6" aria-pressed="false" aria-label="Lead step 7"></button>
                                    <button type="button" class="pad-button" role="gridcell" data-track="blip" data-step="7" aria-pressed="false" aria-label="Lead step 8"></button>
                                </div>
                            </div>
                        </div>
                        <div class="sound-visualizer" aria-hidden="true">
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                            <span class="sound-bar"></span>
                        </div>
                    </section>

                    <section id="instagramPanel" class="content-section screen-panel" data-panel="instagram" hidden>
                        <h2>Instagram</h2>
                        <p>Follow Gold Tooth on Instagram for the latest updates and behind-the-scenes content.</p>
                        <img
                            class="instagram-preview"
                            src="goldtoothinstagram.png"
                            alt="Stylized preview of Gold Tooth's Instagram feed"
                            loading="lazy"
                        >
                        <a class="button-link" href="https://www.instagram.com/gold_tooth_music/?igsh=NTc4MTIwNjQ2YQ%3D%3D" target="_blank" rel="noopener noreferrer">Open Instagram</a>
                    </section>
                        </div>
                    </div>
                </div>

                <footer>
                    <p>&copy; 2025 Gold Tooth. All Rights Reserved.</p>
                </footer>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const showLinks = document.querySelectorAll('.show-list a');
            const toolbarLinks = document.querySelectorAll('.toolbar-link');
            const panels = document.querySelectorAll('.screen-panel');
            const screenInner = document.querySelector('.screen-inner');
            const statusLed = document.querySelector('.status-led');
            const loadingScreen = document.getElementById('loadingScreen');
            const progressBar = loadingScreen ? loadingScreen.querySelector('.loading-bar') : null;
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            let audioContext = null;
            let clickBuffer = null;
            const LOADING_DURATION = 2600;
            const FADE_DURATION = 800;
            const PRESS_DURATION = 150;
            const GLOW_DURATION = 320;
            let dismissTimer = null;
            let hideTimer = null;
            let pressTimer = null;
            let glowTimer = null;
            const SAMPLE_DATA = {
                kick: 'UklGRk8FAABXQVZFZm10IBAAAAABAAEAESsAABErAAABAAgAZGF0YSsFAAB/ho2VnKOpsLa9w8nO09jd4ebp7fDy9ff4'
                    + '+fr7+/r6+ff18/Hu6+fj39vW0s3Hwry2sKqknpiRi4R+eHFrZV9ZU01HQj04My4qJiIfGxgWExEPDg0MCwsLCwwNDhAS'
                    + 'FBYZHB8jJiouMzc8QUZLUFVbYGVrcXZ8gYeNkpedoqessba6v8PHy8/S1tnc3uHj5efo6err6+vr6+rq6efm5OLg3dvY'
                    + '1dLOy8fEwLy3s6+qpqGcmJOOiYSAe3ZxbWhjX1pWUk5KRkI/Ozg1Mi8sKiclIyIgHx0cHBsbGhobGxwcHR4gISMlJykr'
                    + 'LTAzNjk8P0JGSU1QVFhcX2Nna29zd3uAhIiLj5OXm5+ipqmtsLO2uby/wsTHycvOz9HT1NbX2Nna2tvb3Nzc29vb2tnY'
                    + '19bV09LQzszKyMbEwr+9ure0sq+sqaajn5yZlpOPjImGgn98eXVyb2xpZmNgXVpXVVJPTUpIRkNBPz07Ojg2NTQyMTAv'
                    + 'Li0tLCwrKysrKysrKywsLS0uLzAxMjM1Njc5Ojw+QEFDRUdJS01QUlRWWVteYGJlZ2psb3F0dnl7foCDhYiKjY+SlJaY'
                    + 'm52foaOlp6mrra+xsrS2t7m6vL2+v8HCw8TFxcbHyMjJycrKysrLy8vLy8rKysrJycjIx8fGxcTDw8LBwL+9vLu6ube2'
                    + 'tbOysK+trKqpp6akoqGfnZyamJaVk5GPjoyKiIeFg4GAfnx6eXd1dHJwb21samlnZmRjYWBeXVxaWVhXVVRTUlFQT05N'
                    + 'TEtKSUhHR0ZFRURDQ0JCQUFAQD8/Pz8+Pj4+Pj09PT09PT0+Pj4+Pj4/Pz8/QEBBQUFCQkNDRERFRUZHR0hJSUpLS0xN'
                    + 'Tk5PUFFRUlNUVVZXV1hZWltcXV5fYGBhYmNkZWZnaGlqa2xtbm9vcHFyc3R1dnd4eXp7e3x9fn+AgYKCg4SFhoeHiImK'
                    + 'i4uMjY6Oj5CRkZKTk5SVlpaXl5iZmZqbm5ycnZ2enp+goKGhoqKio6OkpKWlpqamp6enqKipqamqqqqqq6urrKysrK2t'
                    + 'ra2urq6urq+vr6+vr7CwsLCwsLCwsbGxsbGxsbGxsbGxsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysbGx'
                    + 'sbGxsbGxsbGxsbGxsbGxsbCwsLCwsLCwsLCwsLCwr6+vr6+vr6+vr6+vr6+urq6urq6urq6urq6urq2tra2tra2tra2t'
                    + 'ra2traysrKysrKysrKysrKysrKysrKurq6urq6urq6urq6urq6urq6urq6urq6qqqqqqqqqqqqqqqqqqqqqqqqqqqqqq'
                    + 'qqqqqqqqqqqqqqqpqampqampqampqampqampqampqampqampqampqamoqKioqKioqKioqKioqKioqKenp6enp6enp6en'
                    + 'p6empqampqampqalpaWlpaWlpaSkpKSkpKSjo6Ojo6OioqKioqGhoaGhoKCgoJ+fn5+fnp6enZ2dnZycnJybm5uampqZ'
                    + 'mZmYmJiXl5eWlpaVlZWUlJOTk5KSkZGRkJCPj46Ojo2NjIyLi4qKiYmIiIiHh4aGhYWEhIODgoKBgYCAf35+fX18fHt7'
                    + 'enp5eXh4d3d2dnV1dHRzc3JycXFwcG9vbm5tbWxsbGtramppaWloaGdnZ2ZmZmVlZWRkZGNjY2JiYmJiYWFhYWFgYGBg'
                    + 'YGBgYF9fX19fX19fX19fX2BgYGBgYGBgYWFhYWJiYmJjY2NkZGRlZWVmZmdnaGhoaWlqamtsbG0=',
                snare: 'UklGRnIEAABXQVZFZm10IBAAAAABAAEAESsAABErAAABAAgAZGF0YU4EAABIpiyTqByQgKmyXW6kujaesIAfcVD1Ga1G'
                    + 'hEncOrw+qLQoX6BInGaWUoo4p3JdslzKoD2ojSfuYaaocC+akWKYvKU7hUTffjSbOYF/d4p+aa491npymDTMUpFuW5DI'
                    + 'Y7qGX2esbpRliopjon+lq5cwb4BVi2t8pG+maIyGZ6dpv2BfVmCpUmaamoWjbEidamKqojTTd0NrYrpAwk2JSWfDQJ5o'
                    + 'Zr89fpt3l6NxdYqRQ1/FU1OGdVmKh1tzXclzq2pspj2QnZ1dYHiyfm2UgaCAc12hVHW6hYB1m4VRnFyFqXCXkzzISK9b'
                    + 'nVFivkN+nklokXhxtJqAXpGMjWC5i2uqcF5xfnmjUYpYia94j5Z3c2mpYbFDq0aZdX6lSWpxopeVZImkkF53pZOXiVVi'
                    + 'uEd0d31krmdcjqV7gnZbb5lcsFuOinmPnGerd32da6uPWYlddaGMWLN2m3VlnI6BoZGTbotibWymULWAZ22bc4uXbV+q'
                    + 'hGmCjYFsbKOXj1iblY1vZpJokmWHfWGzUKNdpHxgo4d0cpFlg4FteqNQmJhpgGWmboGMZ6qIdX5+epdeq3hldYtxfYZr'
                    + 'Z3R8aXCWYpCSiGp2hWGIa3OMb592e5BkdYV8iphXkmhzbJt3folumHWZhHiEcZBniWiVYX+UcIpjmHGLbIxubHaKhopd'
                    + 'lWybe3uUhJKJX4F7eoKNY4VpeIp3goN4d3qCdJiKXKCDj3VnepNmdZKCdoGGjYpok494Z4V/l2qDkXtlm251eJ2Bbpl0'
                    + 'k3GDeIWObIuCjG6Ij2yOZ3WBjWR6eZJnd4aPZHWFkWN4f5F0eX+LbnKMeIePfY12kYmEg4iKcpN0jWWUcHV2fpBziYVs'
                    + 'do+KiYp7jGx2hYKGdHB8f3B6in6Ni4FvcZCDbYN9h2yXeX2Ff3Z1iIJ8ioxqj3l+jH5+bJqBfX5xgpJrfXx3eYuNg3Zy'
                    + 'h3h3dX+PdY5nkXGUcXmRd3p4jmx4hoeLgIWJaXqIim2Ta3+Pa491jnSDb317eYR4fohxkXV5fItyjm+BdIWAinxweoCB'
                    + 'int4dYB+fHSHg4htfI11hXOIgIR+hm+OenORhIRxiYpqkXF9hHOPgm6Kf3eHdoSLfYOJeIRzgHyAi3l0fIR7jICHhX6I'
                    + 'bJBwgXx6jHqIgYhwgoR5h358i3WDgH96e3uMfIh4e36LcoCDfHp5i4VveYWEe3+Jb3x9iIBzent6iXh/d4R7eIeAfYZy'
                    + 'iYZ7g3+EcoCHfXeCg4CFfoSDcoxzjHSIeYJ+f3iFdoR1e4iEd4SBeIWFgnZ+goV4goJ5e4t4hHaCeYp7d4F5fYt/hX51'
                    + 'g4SEd36GeXiEgoF3hHmDdn2JdYd7gHaCfYZ0f4aBdn+JenmGd35/iHp3iXmGe399fIh1hnx/eYd+hYB5goV7e39+fIh2'
                    + 'eoN9f3yId4WBe4d1fYJ6gnd/f4V4fIh+g3iDeoeAg3x8fYZ7foGDgHaB',
                hat: 'UklGRrkCAABXQVZFZm10IBAAAAABAAEAESsAABErAAABAAgAZGF0YZUCAAC8cmKejF3FhkKFnZyjc3CDdZdugIOFd35U'
                    + 'gJtgZGDJk5t6lkOjRcZ7faiLkIBsn07HNKZZX42XSZ2ITLFmYIOOo0qWam5izHKSVG2YgU18dJ53pn9Nrm2xdZdmn0Wx'
                    + 'YZNjrFBtfId/e6CGlJN/WbRncXphmp+GaGuQZaNgsX2BiGJ4kZiHknN2hIWJc3eNmn9pjY9XmVpsk3Fvg6qFcXN0ZpF5'
                    + 'jZd2e3poi6SOcI1ko0uue1+qgH98gXWmhVOFiZKAhoR5iIxxdXyPW4Vvqn6DmIpQnIx6cpaUYWuoeWelfnpmfJBqiGaq'
                    + 'cIaMfGOKnGtmc5ZscoVzfYqPZn6Ye2iGZpiDhIdphJhml4ZhpIlkd5Brf2+QZJWMg36LdZNkb4N+lm6ViWN3g5Vjm2hz'
                    + 'hpV/aHuZeoN+jHyEenuRimeTdo+IYJuHhHxqephzgW+Ld4d4dJRke4F0f4GNhoBse4yFgnR9gnd0iXWLgIWHeGyIdJaH'
                    + 'iGp6jI9/d2+SgoiDiWuWg4dwc4xrkn90eomBjISGh4N2bZmEdoZskX2BjGaHhYtsj4lwgnGEiW+WgHSBiXuHeIeKgHuH'
                    + 'g3txf4l+b4Z4i257eH6Hh4B1e4F3iHaId32BfXt3hoR8dYp2fIV4hIaDb4t3d4+GenSPb4iBdYiEgXSJeXl6i4N7dHmJ'
                    + 'gXGGfXWMfH94jIOEfXx1goZyjIR5iHiEgH10hneAhX2Fcod6gIB4i4N+cXt+h4Vyf3iMgYV8hX+GgXqCgIN0goR+doh1'
                    + 'jHaHcn2Df4R5iHR8jIF9eYZ0joB/e3d+inOHeYN7inOEg3x8h4R7g4B9eH6HeYJ4hHuIeHuGgYN3gniKgnOIeIp8hXiI'
                    + 'gIF+doR/gXeFgXt8iX+C',
                blip: 'UklGRggHAABXQVZFZm10IBAAAAABAAEAESsAABErAAABAAgAZGF0YeQGAADMy8vLy8vLy8vLyzMzMzM0NDQ0NDQ0ysrK'
                    + 'ysrKysrJyTU1NTU1NTU1NTU1ycnIyMjIyMjIyDY2NjY2NjY3Nzc3x8fHx8fHx8fHxzc4ODg4ODg4ODg4xsbGxsbGxcXF'
                    + 'xTk5OTk5OTk5OTk5xMTExMTExMTExDo6Ojo6Ojs7Ozs7w8PDw8PDw8PDwzs8PDw8PDw8PDw8wsLCwsLCwsHBwcE9PT09'
                    + 'PT09PT09wcHBwMDAwMDAwMA+Pj4+Pj4+Pj4/v7+/v7+/v7+/v78/Pz8/P0BAQEBAvr6+vr6+vr6+vr5AQUFBQUFBQUFB'
                    + 'vb29vb29vb29vLxCQkJCQkJCQkJCvLy8vLy8u7u7u7tDQ0NDQ0NDQ0NDu7u7u7q6urq6urpEREREREREREREurm5ubm5'
                    + 'ubm5ublFRUVFRUVFRUVGRri4uLi4uLi4uLhGRkZGRkZGRkdHR7e3t7e3t7e3t7dHR0dHR0dISEhISLa2tra2tra2trZI'
                    + 'SEhISElJSUlJSbW1tbW1tbW1tbVJSUlJSUpKSkpKSrS0tLS0tLS0tLRKSkpKSktLS0tLS7Ozs7Ozs7Ozs7NLS0tLS0xM'
                    + 'TExMTLKysrKysrKysrKyTExMTE1NTU1NTbGxsbGxsbGxsbGxTU1NTU1OTk5OTrCwsLCwsLCwsLCwTk5OTk5OTk9PT6+v'
                    + 'r6+vr6+vr6+vT09PT09PT09PUK6urq6urq6urq6uUFBQUFBQUFBQUK6tra2tra2tra2tUVFRUVFRUVFRUa2tra2srKys'
                    + 'rKysUlJSUlJSUlJSUqysrKysrKysq6urU1NTU1NTU1NTU1Orq6urq6urq6urU1RUVFRUVFRUVFSqqqqqqqqqqqqqVFRU'
                    + 'VFRUVVVVVVWpqampqampqampVVVVVVVVVVVVVVWoqKioqKioqKioVlZWVlZWVlZWVlaoqKioqKinp6enV1dXV1dXV1dX'
                    + 'V1enp6enp6enp6enV1dYWFhYWFhYWFimpqampqampqamWFhYWFhYWFhYWFmlpaWlpaWlpaWlpVlZWVlZWVlZWVmlpaWl'
                    + 'paWlpKSkpFpaWlpaWlpaWlqkpKSkpKSkpKSkpFpaWlpbW1tbW1ujo6Ojo6Ojo6Ojo1tbW1tbW1tbW1ujo6OjoqKioqKi'
                    + 'olxcXFxcXFxcXFyioqKioqKioqKiolxcXF1dXV1dXV2hoaGhoaGhoaGhoV1dXV1dXV1dXV1doaGhoaCgoKCgoF5eXl5e'
                    + 'Xl5eXl5eoKCgoKCgoKCgoF5eXl5eXl9fX19fn5+fn5+fn5+fn19fX19fX19fX19fn5+fn5+fn5+fnmBgYGBgYGBgYGBg'
                    + 'np6enp6enp6enmBgYGBgYGBgYGBgnp6dnZ2dnZ2dnWFhYWFhYWFhYWFhnZ2dnZ2dnZ2dnWFhYWFhYWFhYmJinJycnJyc'
                    + 'nJycnJxiYmJiYmJiYmJinJycnJycnJycnJxiYmJjY2NjY2Njm5ubm5ubm5ubm5tjY2NjY2NjY2Njm5ubm5ubm5ubm5tk'
                    + 'ZGRkZGRkZGRkmpqampqampqamppkZGRkZGRkZGRkmpqampqampqampllZWVlZWVlZWVlmZmZmZmZmZmZmZllZWVlZWVl'
                    + 'ZWVlZZmZmZmZmZmZmZlmZmZmZmZmZmZmZpiYmJiYmJiYmJhmZmZmZmZmZmZmZpiYmJiYmJiYmJhmZmdnZ2dnZ2dnZ5eX'
                    + 'l5eXl5eXl5dnZ2dnZ2dnZ2dnZ5eXl5eXl5eXl5dnZ2dnZ2doaGhoaJaWlpaWlpaWlpZoaGhoaGhoaGhoaJaWlpaWlpaW'
                    + 'lpZoaGhoaGhoaGhoaJaVlZWVlZWVlZWVaWlpaWlpaWlpaZWVlZWVlZWVlZWVaWlpaWlpaWlpaZWVlZWVlZWVlZSUampq'
                    + 'ampqampqapSUlJSUlJSUlJSUampqampqampqapSUlJSUlJSUlJSUampqampqampra5OTk5OTk5OTk5OTa2tra2tra2tr'
                    + 'a5OTk5OTk5OTk5OTa2tra2tra2tra5OTk5OTk5OTk5OTbGxsbGxsbGxsbGySkpKSkpKSkpKSbGxsbGxsbGxsbGySkpKS'
                    + 'kpKSkpKSbGxsbGxsbGxsbGySkpKSkpKRkZGRbW1tbW1tbW1tbW2RkZGRkZGRkZGRbW1tbW1tbW1tbW2RkZGRkZGRkZGR'
                    + 'bW1tbW1tbW1tbW2RkZGRkJCQkJCQbm5ubm5ubm5ubm6QkJCQkJCQkJCQkG5ubm5ubm5ubm6QkJCQkJCQkJCQkG5ubm5u'
                    + 'bm5ubm6QkJCQkJCPj4+Pj29vb29vb29vb2+Pj4+Pj4+Pj4+Pj29vb29vb29vb2+Pj4+Pj4+Pj4+Pj29vb29vb29vb2+P'
                    + 'j4+Pj4+Pj4+Pj29wcHA=',
            };
            const TRACKS = [
                { id: 'kick', sampleKey: 'kick' },
                { id: 'snare', sampleKey: 'snare' },
                { id: 'hat', sampleKey: 'hat' },
                { id: 'blip', sampleKey: 'blip' },
            ];
            const STEP_COUNT = 8;
            const SCHEDULER_LOOKAHEAD = 0.1;
            const SCHEDULER_INTERVAL = 25;
            const sequencerPanel = document.getElementById('spotifyPanel');
            const stepButtons = sequencerPanel ? Array.from(sequencerPanel.querySelectorAll('.pad-button')) : [];
            const startButton = sequencerPanel ? sequencerPanel.querySelector('[data-action="start"]') : null;
            const stopButton = sequencerPanel ? sequencerPanel.querySelector('[data-action="stop"]') : null;
            const tempoInput = sequencerPanel ? sequencerPanel.querySelector('#tempoInput') : null;
            const tempoDisplay = sequencerPanel ? sequencerPanel.querySelector('#tempoDisplay') : null;
            const trackPatterns = new Map();
            TRACKS.forEach(track => {
                trackPatterns.set(track.id, new Array(STEP_COUNT).fill(false));
            });
            const sampleCache = new Map();
            const samplePromises = new Map();
            const visualTimers = new Set();
            let sequencerTimer = null;
            let isPlayingSequence = false;
            let currentStep = 0;
            let nextNoteTime = 0;

            const highlightStep = step => {
                stepButtons.forEach(button => {
                    const isMatch = typeof step === 'number' && Number(button.dataset.step) === step;
                    button.classList.toggle('is-active', isMatch);
                });
            };

            const clearVisualTimers = () => {
                visualTimers.forEach(timerId => {
                    window.clearTimeout(timerId);
                });
                visualTimers.clear();
            };

            const updateTransportButtons = playing => {
                if (startButton) {
                    startButton.disabled = playing;
                    startButton.setAttribute('aria-pressed', playing ? 'true' : 'false');
                }
                if (stopButton) {
                    stopButton.disabled = !playing;
                    stopButton.setAttribute('aria-pressed', 'false');
                }
            };

            const base64ToArrayBuffer = base64 => {
                const binaryString = window.atob(base64);
                const length = binaryString.length;
                const bytes = new Uint8Array(length);
                for (let i = 0; i < length; i += 1) {
                    bytes[i] = binaryString.charCodeAt(i);
                }
                return bytes.buffer;
            };

            const scheduleVisualCue = (step, time) => {
                const context = ensureAudioContext();
                if (!context) {
                    return;
                }
                const delay = Math.max(0, (time - context.currentTime) * 1000);
                const timerId = window.setTimeout(() => {
                    highlightStep(step);
                    visualTimers.delete(timerId);
                }, delay);
                visualTimers.add(timerId);
            };

            const loadSample = key => {
                if (!SAMPLE_DATA[key]) {
                    return Promise.resolve(null);
                }
                if (sampleCache.has(key)) {
                    return Promise.resolve(sampleCache.get(key));
                }
                if (samplePromises.has(key)) {
                    return samplePromises.get(key);
                }
                const context = ensureAudioContext();
                if (!context) {
                    return Promise.resolve(null);
                }
                const arrayBuffer = base64ToArrayBuffer(SAMPLE_DATA[key]);
                const promise = context.decodeAudioData(arrayBuffer).then(buffer => {
                    sampleCache.set(key, buffer);
                    samplePromises.delete(key);
                    return buffer;
                }).catch(error => {
                    console.error('Failed to decode sample', key, error);
                    samplePromises.delete(key);
                    return null;
                });
                samplePromises.set(key, promise);
                return promise;
            };

            const loadAllSamples = () => Promise.all(TRACKS.map(track => loadSample(track.sampleKey)));

            const getTempo = () => {
                if (!tempoInput) {
                    return 110;
                }
                const parsed = Number(tempoInput.value);
                return Number.isFinite(parsed) ? parsed : 110;
            };

            const getStepDuration = () => (60 / getTempo()) / 2;

            const updateTempoDisplay = () => {
                if (tempoDisplay) {
                    tempoDisplay.textContent = `${getTempo()} BPM`;
                }
            };

            const scheduleStep = (step, time) => {
                const context = ensureAudioContext();
                if (!context) {
                    return;
                }
                TRACKS.forEach(track => {
                    const pattern = trackPatterns.get(track.id);
                    if (!pattern || !pattern[step]) {
                        return;
                    }
                    const buffer = sampleCache.get(track.sampleKey);
                    if (!buffer) {
                        return;
                    }
                    const source = context.createBufferSource();
                    source.buffer = buffer;
                    source.connect(context.destination);
                    source.start(time);
                });
                scheduleVisualCue(step, time);
            };

            const scheduleLoop = () => {
                const context = ensureAudioContext();
                if (!context || !isPlayingSequence) {
                    return;
                }
                const stepDuration = getStepDuration();
                while (nextNoteTime < context.currentTime + SCHEDULER_LOOKAHEAD) {
                    const stepToSchedule = currentStep;
                    scheduleStep(stepToSchedule, nextNoteTime);
                    nextNoteTime += stepDuration;
                    currentStep = (currentStep + 1) % STEP_COUNT;
                }
            };

            const stopSequencer = () => {
                if (!isPlayingSequence) {
                    updateTransportButtons(false);
                    return;
                }
                isPlayingSequence = false;
                if (sequencerTimer) {
                    clearInterval(sequencerTimer);
                    sequencerTimer = null;
                }
                clearVisualTimers();
                highlightStep(null);
                updateTransportButtons(false);
            };

            const startSequencer = () => {
                if (!sequencerPanel) {
                    return;
                }
                const context = ensureAudioContext();
                if (!context) {
                    return;
                }

                const beginPlayback = () => {
                    if (isPlayingSequence) {
                        return;
                    }
                    clearVisualTimers();
                    highlightStep(null);
                    isPlayingSequence = true;
                    currentStep = 0;
                    nextNoteTime = context.currentTime + 0.05;
                    scheduleLoop();
                    if (sequencerTimer) {
                        clearInterval(sequencerTimer);
                    }
                    sequencerTimer = window.setInterval(scheduleLoop, SCHEDULER_INTERVAL);
                    updateTransportButtons(true);
                };

                loadAllSamples().then(() => {
                    if (context.state === 'suspended') {
                        context.resume().then(() => {
                            beginPlayback();
                        }).catch(error => {
                            console.error('Audio resume failed:', error);
                        });
                        return;
                    }
                    beginPlayback();
                });
            };

            updateTempoDisplay();
            updateTransportButtons(false);

            if (tempoInput) {
                tempoInput.addEventListener('input', updateTempoDisplay);
            }

            stepButtons.forEach(button => {
                const trackId = button.dataset.track;
                const stepIndex = Number(button.dataset.step);
                button.addEventListener('click', () => {
                    const pattern = trackPatterns.get(trackId);
                    if (!pattern || Number.isNaN(stepIndex)) {
                        return;
                    }
                    const nextState = !pattern[stepIndex];
                    pattern[stepIndex] = nextState;
                    button.classList.toggle('is-on', nextState);
                    button.setAttribute('aria-pressed', nextState ? 'true' : 'false');
                    playClick();
                });
            });

            if (startButton) {
                startButton.addEventListener('click', event => {
                    event.preventDefault();
                    playClick();
                    startSequencer();
                });
            }

            if (stopButton) {
                stopButton.addEventListener('click', event => {
                    event.preventDefault();
                    playClick();
                    stopSequencer();
                });
            }

            const createClickBuffer = (context) => {
                if (!context) {
                    return null;
                }

                const duration = 0.08;
                const sampleRate = context.sampleRate;
                const frameCount = Math.floor(sampleRate * duration);
                const buffer = context.createBuffer(1, frameCount, sampleRate);
                const data = buffer.getChannelData(0);

                for (let i = 0; i < frameCount; i += 1) {
                    const decay = Math.exp(-i / (frameCount / 2));
                    const noise = Math.random() * 2 - 1;
                    data[i] = noise * decay * 0.35;
                }

                return buffer;
            };

            const ensureAudioContext = () => {
                if (!AudioContext) {
                    return null;
                }

                if (!audioContext) {
                    audioContext = new AudioContext();
                }

                if (!clickBuffer) {
                    clickBuffer = createClickBuffer(audioContext);
                }

                return audioContext;
            };

            const clearTimers = () => {
                if (dismissTimer) {
                    clearTimeout(dismissTimer);
                    dismissTimer = null;
                }
                if (hideTimer) {
                    clearTimeout(hideTimer);
                    hideTimer = null;
                }
            };

            const resetLoadingScreen = () => {
                if (!loadingScreen) {
                    return;
                }

                clearTimers();
                loadingScreen.classList.remove('fade-out', 'is-hidden');
                loadingScreen.style.removeProperty('display');

                if (progressBar) {
                    progressBar.style.animation = 'none';
                    // Trigger a reflow so that the animation can restart.
                    // eslint-disable-next-line no-unused-expressions
                    progressBar.offsetWidth;
                    progressBar.style.animation = '';
                }

                document.body.classList.remove('loaded');
            };

            const playClick = () => {
                const context = ensureAudioContext();

                if (!context || !clickBuffer) {
                    return;
                }

                const startPlayback = () => {
                    if (!clickBuffer) {
                        return;
                    }

                    const source = context.createBufferSource();
                    source.buffer = clickBuffer;
                    source.connect(context.destination);
                    source.start();
                };

                if (context.state === 'suspended') {
                    const resumeResult = context.resume();

                    if (resumeResult && typeof resumeResult.then === 'function') {
                        resumeResult.then(startPlayback).catch(error => {
                            console.error('Audio resume failed:', error);
                        });
                    } else {
                        startPlayback();
                    }
                    return;
                }

                startPlayback();
            };

            const activatePanel = (destination) => {
                const matchedPanel = Array.from(panels).find(panel => panel.dataset.panel === destination);

                if (!matchedPanel) {
                    return null;
                }

                panels.forEach(panel => {
                    const isMatch = panel === matchedPanel;
                    panel.toggleAttribute('hidden', !isMatch);
                    panel.classList.toggle('is-active', isMatch);
                });

                if (matchedPanel.dataset.panel !== 'spotify') {
                    stopSequencer();
                }

                return matchedPanel;
            };

            const triggerPressEffect = () => {
                if (!screenInner) {
                    return;
                }

                if (pressTimer) {
                    clearTimeout(pressTimer);
                    pressTimer = null;
                }

                screenInner.classList.remove('is-pressing');
                // eslint-disable-next-line no-unused-expressions
                screenInner.offsetWidth;
                screenInner.classList.add('is-pressing');

                pressTimer = window.setTimeout(() => {
                    screenInner.classList.remove('is-pressing');
                    pressTimer = null;
                }, PRESS_DURATION);
            };

            const triggerLedGlow = () => {
                if (!statusLed) {
                    return;
                }

                if (glowTimer) {
                    clearTimeout(glowTimer);
                    glowTimer = null;
                }

                statusLed.classList.remove('is-glowing');
                // eslint-disable-next-line no-unused-expressions
                statusLed.offsetWidth;
                statusLed.classList.add('is-glowing');

                glowTimer = window.setTimeout(() => {
                    statusLed.classList.remove('is-glowing');
                    glowTimer = null;
                }, GLOW_DURATION);
            };

            showLinks.forEach(link => {
                link.addEventListener('click', function(event) {
                    event.preventDefault();

                    playClick();

                    setTimeout(() => {
                        window.open(link.href, link.target);
                    }, 150);
                });
            });

            toolbarLinks.forEach(link => {
                link.addEventListener('click', function(event) {
                    const destination = link.dataset.destination;
                    if (!destination) {
                        return;
                    }

                    const panel = activatePanel(destination);
                    if (!panel) {
                        return;
                    }

                    event.preventDefault();
                    playClick();

                    toolbarLinks.forEach(toolbarLink => {
                        toolbarLink.classList.toggle('is-active', toolbarLink === link);
                    });

                    triggerPressEffect();
                    triggerLedGlow();
                });
            });

            activatePanel('shows');
            toolbarLinks.forEach(link => {
                link.classList.toggle('is-active', link.dataset.destination === 'shows');
            });

            const dismissLoadingScreen = () => {
                if (!loadingScreen) {
                    document.body.classList.add('loaded');
                    return;
                }

                document.body.classList.add('loaded');
                loadingScreen.classList.add('fade-out');
                hideTimer = window.setTimeout(() => {
                    loadingScreen.classList.add('is-hidden');
                }, FADE_DURATION);
            };

            const startLoadingSequence = () => {
                if (!loadingScreen) {
                    document.body.classList.add('loaded');
                    return;
                }

                resetLoadingScreen();

                if (document.readyState === 'complete') {
                    dismissTimer = window.setTimeout(dismissLoadingScreen, LOADING_DURATION);
                } else {
                    window.addEventListener('load', () => {
                        dismissTimer = window.setTimeout(dismissLoadingScreen, LOADING_DURATION);
                    }, { once: true });
                }
            };

            startLoadingSequence();

            window.addEventListener('pageshow', event => {
                const hasPerformanceApi = typeof performance !== 'undefined'
                    && typeof performance.getEntriesByType === 'function';
                const navigationEntries = hasPerformanceApi ? performance.getEntriesByType('navigation') : [];
                const cameFromHistory = event.persisted || (navigationEntries[0] && navigationEntries[0].type === 'back_forward');

                if (cameFromHistory) {
                    startLoadingSequence();
                }
            });
        });
    </script>
</body>
</html>
